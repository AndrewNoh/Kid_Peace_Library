{% extends "base.html" %}
{% block head %}
{% block title %}글쓰기{% endblock %}
	{{super()}}
	<!-- <script src="//cdn.ckeditor.com/4.5.3/standard/ckeditor.js"></script> -->
	<script type="text/javascript" src="{{url_for('static', filename='ckeditor/ckeditor.js')}}"></script>
{% endblock %}
{% block body %}
	{% block Nav %}
		{{super()}}
	{% endblock %}
<section id="write" style="margin-top:50px;">
  <div class = "container">
 		 <div class="panel-heading">
        	<div class="panel-title" style="font-size:20px; text-align:center;">{{board_name}}</div>
   		 </div>
		<form method="POST" action="{{url_for('.create', category=board_name)}}"> 
		{% if session['permission'] == "Admin" %}
			<div class="form-group">
				<label for="notice"><input type="checkbox" id="notice" name="notice" oninput="noticecheck()"> 공 지</label>
			</div>
		{% endif %}
		    <div class="form-group">
		      <label for="subject" class="">Title:</label>
		      <input type="text" class="form-control" name ="subject" id="subject" oninput="title_spaceCheck()" placeholder="Enter title">
		    </div>
		    <div class="form-group">
		      <label for="content">Comment:</label>
		      <textarea id="editor1" name="editor1"  onchange="title_spaceCheck()" placeholder="Describe yourself here..."></textarea>
		    </div>
		    <div class="form-group">
		      <input type="file" class="btn btn-default pull-left" id="File">
		    </div>
		    <div class="form-group">
		        <button type="submit" id="board_write" class="btn btn-primary pull-right" disabled="disabled">Submit</button>
		    </div>
		</form>
  </div>
</section>
	
	{% block Footer %}
		{{super()}}
	{% endblock %}

	{% block jquery %}
		{{super()}}
	{% endblock %}
	<script>
    CKEDITOR.replace( 'editor1', {
        filebrowserImageUploadUrl: '/ckupload/'
    });
    $(function(){
    	title_spaceCheck();
    });
    function null_check(str){
  	  if(str.length==0 || !str.trim()){
  		  return true;
  	  }
  	  return false;
     }
    
      function title_spaceCheck(){
  		var subject = $('#subject').val()
  		//var text = CKEDITOR.instances.editor1.getData();
  		if(null_check(subject)){
  			$('#board_write').prop("disabled", true);
  		}
  		else{
  			$('#board_write').prop("disabled", false);
  		}
  	}

/*
    $(function (){
    	$('#board_write').click(function(){
    		var subject = $('#subject').val();
    		var editor1 = CKEDITOR.instances.editor1.getData();

    		if(subject=='' || editor1==''){
    			alert("제목, 혹은 내용을 작성하세요.")
        		return
        	}
			$.ajax({
				url : "{{url_for('.create', category=board_name)}}",
				type : 'POST',
				dataType : "json",
				data : {subject:$('#subject').val(), editor1:CKEDITOR.instances.editor1.getData()},
				async: false,
				success : function(data) {
					status = $.trim(data.status);
					if (status == 'fail') {
						alert('Error! 글쓰기 실패!');
					} else if (status == 'ok') {
						alert('글쓰기 완료');
						window.location.replace("{{url_for('.board_list', category=board_name)}}")
					} else if (status == 'error') {
						alert('Error!');
					}
				},
				error : function(error) {
					console.log(error);
				}
			});
		});
    });
*/
    
	</script>
{% endblock %}
